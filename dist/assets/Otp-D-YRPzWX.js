import{r as h,j as e}from"./react-DpEaTGvj.js";import{a as f,u as g}from"./react-redux-DOrOl4D1.js";import{P as j,m as y,n as O,p as P,q as T,t as b,u as S,s as v}from"./index-Gc4YVrAH.js";import{O as w}from"./react-otp-input-kFSZkYLf.js";import{B as o}from"./react-toastify-C68LgtoO.js";import{a as z}from"./react-router-CtV_OVEe.js";import{G as s,P as A,T as m,b as C,ad as E}from"./@mui-D6pazF8g.js";import"./@babel-BSpAw9Ks.js";import"./use-sync-external-store-rswVQh-A.js";import"./react-dom-D1vaxf0J.js";import"./scheduler-CzFDRTuY.js";import"./react-router-dom-utljeJSg.js";import"./@remix-run-BOUEh3jQ.js";import"./axios-DzWr6d29.js";import"./@reduxjs-DYPsSoVN.js";import"./redux-DITMfSWq.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./redux-persist-T4x0BtfD.js";import"./clsx-B-dksMZM.js";import"./@emotion-C00rQ2ai.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./stylis-FDnFs_-n.js";import"./react-is-DcfIKM1A.js";import"./react-transition-group-C7fztySn.js";function re(){const[i,l]=h.useState(""),n=f(),a=z(),{username:c,password:p}=g(t=>t.auth),u=async t=>{t.preventDefault();const x={username:c,password:p,otp:i};try{const r=await y(x);console.log(r),r.success?(n(O(i)),n(P(!0)),n(T(r.token)),n(b(r.data.role)),n(S(r.data.organization)),o.success("Login successful!"),r.data.role==="admin"?a("/admin"):a("/dashboard")):o.error("OTP does not match.")}catch(r){console.error(r),o.error("OTP verification failed.")}},d=async()=>{try{(await v({username:c,password:p})).success?o.success("OTP resent successfully!"):o.error("Failed to resend OTP.")}catch(t){console.error(t),o.error("Error resending OTP.")}};return e.jsx(j,{showheader:!0,showfooter:!0,className:"bgImg",style:{display:"grid",placeContent:"center"},children:e.jsx(s,{container:!0,m:0,children:e.jsx(s,{item:!0,xs:12,children:e.jsx(A,{sx:{borderRadius:"10px"},children:e.jsx(s,{container:!0,p:2,children:e.jsxs("form",{onSubmit:u,children:[e.jsx(s,{item:!0,xs:12,mt:2,children:e.jsx(m,{fontSize:"x-large",sx:{color:"#0c1352",textAlign:"center"},children:"Enter OTP To Verify E-Mail"})}),e.jsx(s,{item:!0,xs:12,mt:3,display:"flex",justifyContent:"center",children:e.jsx(w,{inputStyle:{width:"2rem",height:"4vh",fontSize:"18px"},value:i,onChange:l,numInputs:6,renderSeparator:e.jsx("span",{children:"     "}),renderInput:t=>e.jsx("input",{...t})})}),e.jsx(s,{item:!0,xs:12,mt:3,textAlign:"center",children:e.jsx(C,{variant:"contained",color:"primary",size:"small",sx:{bgcolor:"#0c113b"},type:"submit",children:"Submit"})}),e.jsx(s,{item:!0,xs:12,textAlign:"center",py:1,children:e.jsx(E,{to:"#",style:{textDecoration:"none"},onClick:d,children:e.jsx(m,{style:{cursor:"pointer"},children:"Resend One-Time Password"})})})]})})})})})})}export{re as default};
