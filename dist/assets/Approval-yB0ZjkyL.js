import{r as d,j as e}from"./react-BEjMjN8G.js";import{T as U,a as I,b as j,c as g}from"./react-tabs-zJnOQWKe.js";import{G as t,m as A,a4 as F,T as s,a5 as x,al as G,P as u,am as D,c as H,d as _,e as L,f as M,g as q,an as J,ao as N,ap as K,b as S,aq as Q,s as f,h as V,t as R}from"./@mui-Cxlh-61e.js";import{u as C}from"./react-redux-BCzlrtQJ.js";import{A as X,v as Y,w as Z,x as ee,y as re,z as ne}from"./index-Cu_Ucmoy.js";import"./@babel-BE2LeGo5.js";import"./clsx-B-dksMZM.js";import"./@emotion-DFtIIxQb.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./stylis-FDnFs_-n.js";import"./react-is-DcfIKM1A.js";import"./react-transition-group-CMj4CyiH.js";import"./react-dom-UOU5xRcb.js";import"./scheduler-CzFDRTuY.js";import"./use-sync-external-store-CL43r71C.js";import"./react-router-dom-CdDO6LQr.js";import"./react-router-DNCBPsEY.js";import"./@remix-run-BOUEh3jQ.js";import"./react-otp-input-CPsintEO.js";import"./axios-DzWr6d29.js";import"./react-toastify-jL36amYw.js";import"./@reduxjs-DYPsSoVN.js";import"./redux-DITMfSWq.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./redux-persist-CW-G7xl2.js";const a=f(V)(({theme:l})=>({[`&.${R.head}`]:{backgroundColor:l.palette.common.black,color:l.palette.common.white,padding:"10px",height:"20px",fontSize:"16px",lineHeight:"1.5"},[`&.${R.body}`]:{fontSize:14}})),se=f(M)(({theme:l})=>({"&:nth-of-type(odd)":{backgroundColor:l.palette.action.hover},"&:last-child td, &:last-child th":{border:0}})),te=f(t)(({theme:l})=>({padding:l.spacing(2),borderBottom:`1px solid ${l.palette.divider}`,backgroundColor:l.palette.grey[100]})),ae=f(t)(({theme:l})=>({padding:l.spacing(2),borderBottom:`1px solid ${l.palette.divider}`,backgroundColor:"white"}));function De(){const l=C(r=>r.auth.organization),[P,w]=d.useState(!1),[c,E]=d.useState([]),[W,y]=d.useState(!1),[T,m]=d.useState(null),[i,k]=d.useState(null),o=C(r=>r.auth.role),p=C(r=>r.auth.authToken),v=async()=>{y(!0),m(null);let r;if(o==="manager")r=re;else if(o==="owner")r=ne;else{m("Invalid role"),y(!1);return}try{const n=await r(l);n.success?E(n.approvedOwnerUsers||n.approvedManagerUsers||[]):m(n.message||"Failed to fetch users")}catch(n){console.error("Error:",n),m("An error occurred while fetching users")}finally{y(!1)}},O=async r=>{let n;const h={employeeID:r.employeeID};try{o==="manager"?n=await X(h,p):o==="owner"&&(n=await Y(h,p)),n&&n.success?(alert("User approved successfully"),v()):alert(n.message||"Approval failed")}catch(b){console.error("Approval error:",b),alert("An error occurred while approving the user")}},$=async r=>{let n;const h={employeeID:r.employeeID};try{o==="manager"?n=await Z(h,p):o==="owner"&&(n=await ee(h,p)),n&&n.success?(alert("User rejected successfully"),v()):alert(n.message||"Rejection failed")}catch(b){console.error("Rejection error:",b),alert("An error occurred while rejecting the user")}};d.useEffect(()=>{(o==="manager"||o==="owner")&&v()},[o,p]);const z=r=>{k(r),w(!0)},B=()=>{w(!1),k(null)};return e.jsxs(t,{container:!0,spacing:2,p:2,children:[e.jsxs(t,{item:!0,xs:12,container:!0,alignItems:"center",children:[e.jsx(A,{children:e.jsx(F,{sx:{fontSize:30,color:"green "}})}),e.jsx(s,{variant:"h4",mt:1,children:"Message Box"})]}),e.jsxs(t,{item:!0,xs:12,children:[W&&e.jsx(x,{display:"flex",justifyContent:"center",my:2,children:e.jsx(G,{})}),T&&e.jsx(s,{color:"error",align:"center",children:T})]}),e.jsx(t,{container:!0,sx:{display:{sm:"block",xs:"block",md:"none",lg:"none"}},children:e.jsxs(U,{children:[e.jsxs(I,{children:[e.jsx(j,{style:{whiteSpace:"break-spaces"},children:e.jsx(s,{fontSize:"large",children:"User Approval"})}),e.jsx(j,{children:e.jsx(s,{fontSize:"large",children:"Add Well Approval"})})]}),e.jsx(g,{children:e.jsx(u,{elevation:3,sx:{padding:3,maxWidth:600},children:e.jsx(t,{container:!0,mt:2,direction:"column",children:c==null?void 0:c.map((r,n)=>e.jsxs(t,{container:!0,mb:2,children:[e.jsx(te,{item:!0,xs:4,children:e.jsx(s,{variant:"body1",sx:{fontWeight:"bold"},children:`User ${n+1}`})}),e.jsxs(ae,{item:!0,xs:8,children:[e.jsx(s,{variant:"body1",children:r.username}),e.jsx(s,{variant:"body1",children:r.email}),e.jsx(s,{variant:"body1",children:r.contactNumber}),e.jsx(A,{onClick:()=>z(r),sx:{color:"black","&:hover":{color:"darkred"},marginTop:1},children:e.jsx(D,{fontSize:"large"})})]})]},r._id||n))})})}),e.jsx(g,{children:e.jsx(s,{variant:"body1",children:"Add Well Approval Content"})})]})}),e.jsx(t,{container:!0,children:e.jsx(t,{item:!0,md:12,lg:12,sm:12,xs:12,sx:{display:{sm:"none",xs:"none",md:"block",lg:"block"}},children:e.jsxs(U,{children:[e.jsxs(I,{children:[e.jsx(j,{style:{whiteSpace:"break-spaces"},children:e.jsx(s,{fontSize:"large",children:"User Approval"})}),e.jsx(j,{children:e.jsx(s,{fontSize:"large",children:"Add Well Approval"})})]}),e.jsx(g,{children:e.jsx(H,{component:u,sx:{border:"1px solid black",maxHeight:500},children:e.jsxs(_,{"aria-label":"customized table",stickyHeader:!0,children:[e.jsx(L,{children:e.jsxs(M,{children:[e.jsx(a,{children:"Number"}),e.jsx(a,{align:"left",children:"Username"}),e.jsx(a,{align:"center",children:"Email"}),e.jsx(a,{align:"center",children:"Phone No."}),e.jsx(a,{align:"left",children:"Department"}),e.jsx(a,{align:"center",children:"Approval Status"}),e.jsx(a,{align:"center",children:"Action"})]})}),e.jsx(q,{children:c==null?void 0:c.map((r,n)=>e.jsxs(se,{children:[e.jsx(a,{component:"th",scope:"row",children:n+1}),e.jsx(a,{align:"left",children:r.username}),e.jsx(a,{align:"center",children:r.email}),e.jsx(a,{align:"center",children:r.contactNumber}),e.jsx(a,{align:"left",children:r.department||"N/A"}),e.jsx(a,{align:"center",children:r.isApprovedByManager?"Approved By Manager! Waiting Owner Approval":"Pending Approval"}),e.jsx(a,{align:"center",children:e.jsx(x,{display:"flex",justifyContent:"space-evenly",children:e.jsx(A,{onClick:()=>z(r),sx:{color:"black","&:hover":{color:"darkred"},marginRight:"5px"},children:e.jsx(D,{fontSize:"large"})})})})]},r._id||n))})]})})}),e.jsx(g,{children:e.jsx(s,{variant:"body1",children:"Add Well Approval Content"})})]})})}),e.jsxs(J,{open:P,onClose:B,maxWidth:"md",fullWidth:!0,children:[e.jsx(N,{variant:"h4",textAlign:"center",children:"Approval User"}),e.jsx(K,{children:i?e.jsxs(t,{container:!0,spacing:3,children:[e.jsxs(t,{container:!0,spacing:4,children:[e.jsxs(t,{item:!0,ml:3,xs:12,sm:4,md:5,lg:5,children:[e.jsx(N,{variant:"h6",mt:2,children:"REGISTRATION DETAILS :-"}),e.jsxs(s,{fontSize:"large",children:[e.jsx("strong",{children:"Employee ID:"})," ",i.employeeID]}),e.jsxs(s,{fontSize:"large",children:[e.jsx("strong",{children:"Username:"})," ",i.username]}),e.jsxs(s,{fontSize:"large",children:[e.jsx("strong",{children:"Email:"})," ",i.email]}),e.jsxs(s,{fontSize:"large",children:[e.jsx("strong",{children:"Contact Number:"})," ",i.contactNumber]}),e.jsxs(s,{fontSize:"large",children:[e.jsx("strong",{children:"Asset Name:"})," ",i.organizationName||"N/A"]}),e.jsxs(s,{fontSize:"large",children:[e.jsx("strong",{children:"Department:"})," ",i.department||"N/A"]}),e.jsxs(s,{fontSize:"large",children:[e.jsx("strong",{children:"Role in RTMS:"})," ",i.roleInRTMS]})]}),e.jsxs(t,{item:!0,xs:12,sm:8,md:8,lg:6,gap:2,sx:{display:"flex",alignItems:"end"},children:[e.jsx(t,{item:!0,xs:12,children:e.jsx(u,{elevation:1,children:e.jsx(x,{paddingTop:2,paddingBottom:2,children:e.jsx("img",{src:i.idCardPhoto,alt:"User ID Card",style:{objectFit:"contain",width:"100%",height:"25vh"}})})})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(u,{elevation:1,children:e.jsx(x,{paddingTop:2,paddingBottom:2,children:e.jsx("img",{src:i.passportPhoto,alt:"User Passport Photo",style:{objectFit:"contain",width:"100%",height:"25vh"}})})})})]})]}),e.jsxs(t,{container:!0,spacing:2,alignItems:"center",mt:2,ml:1,children:[e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsxs(s,{variant:"h5",textAlign:"left",children:["Status:"," ",i.isApprovedByManager?"Approved By Manager! Waiting Owner Approval":"Pending Approval"]})}),e.jsx(t,{item:!0,xs:12,sm:6,textAlign:"end",children:e.jsxs(x,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(S,{variant:"contained",color:"primary",size:"large",onClick:()=>O(i),children:"Approve"}),e.jsx(S,{variant:"contained",color:"secondary",size:"large",onClick:()=>$(i),children:"Reject"})]})})]})]}):e.jsx(s,{children:"No user selected."})}),e.jsx(Q,{children:e.jsx(S,{onClick:B,color:"primary",children:"Close"})})]})]})}export{De as default};
